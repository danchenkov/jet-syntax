{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Jet Template",
  "scopeName": "text.html.jet",
  "fileTypes": ["jet", "jet.html", "html"],
  "patterns": [
    { "include": "#frontmatterYAML" },
    { "include": "#comment" },
    { "include": "#jetBlock" },
    { "include": "#quotedStrings" },
    { "include": "#content" }
  ],
  "repository": {
    "frontmatterYAML": {
      "begin": "^---\\s*$",
      "end": "^---\\s*$",
      "name": "meta.embedded.block.frontmatter",
      "contentName": "source.yaml",
      "patterns": [
        { "include": "source.yaml" }
      ]
    },
    "comment": {
      "begin": "\\{\\*",
      "end": "\\*\\}",
      "name": "comment.block.jet"
    },
    "jetBlock": {
      "patterns": [
        {
          "name": "support.constant.jet",
          "match": "(?<=\\{\\{)\\s*(if|else if|else|end|block|yield|range|extends|include|import|continue|break)"
        },
        {
          "name": "keyword.operator.assignment.jet",
          "match": ":="
        },
        {
          "name": "variable.language.jet",
          "match": "\\.[a-zA-Z_][a-zA-Z0-9_]*"
        },
        {
          "name": "variable.other.property.jet",
          "match": "[a-zA-Z_][a-zA-Z0-9_]*(?=\\[)"
        },
        {
          "name": "support.function.builtin.jet",
          "match": "\\b(isset|len|lower|upper|hasPrefix|hasSuffix|repeat|replace|splt|trimSpace|html|url|safeHtml|safeJs|raw|writeJson|map|T|Lookup)\\b(?=\\()"
        },
        {
          "name": "support.function.piped.jet",
          "match": "(?<=\\|)\\s*(lower|upper|hasPrefix|hasSuffix|repeat|replace|splt|trimSpace|html|url|safeHtml|safeJs|raw|writeJson)"
        },
        {
          "name": "punctuation.accessor.bracket.jet",
          "match": "\\[|\\]"
        },
        {
          "name": "constant.character.escape.jet",
          "match": "\\\\."
        }
      ]
    },
    "quotedStrings": {
      "begin": "\"",
      "end": "\"",
      "name": "string.quoted.double.jet",
      "patterns": [
        {
          "name": "constant.character.escape.jet",
          "match": "\\\\."
        }
      ]
    },
    "content": {
      "include": "text.html.basic"
    }
  }
}
